@model Models.Entity.Customer
@{
    ViewBag.Title = "CheckOut";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section jsFooter{
    <script>
        $('#orderButtonAjax').off('click').on('click', function (e) {
            var cartItemsList = JSON.parse(localStorage.getItem("cartItemsList"));
            if (cartItemsList == null) {
                window.alert('Hiện tại không có sản phẩm nào trong giỏ hàng !')
                return;
            }
            $.ajax({
                url: "/Product/AddCart",
                data: { data: JSON.stringify(cartItemsList) },
                dataType: "json",
                type: "POST",
                success: function (res) {
                    if (res) {
                        $('#orderButtonPostBack').click();
                        console.log(res);
                    }
                    else {
                        console.log(res.product);
                    }
                }
            });
        });
    </script>
    <script>
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            $(window).scrollTop(300); 
                            event.preventDefault();
                            event.stopPropagation();
                            //$('#theFormId').submit();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
}
<!-- Page Banner Section Start -->
<div class="page-banner-section section bg-gray">
    <div class="container">
        <div class="row">
            <div class="col">

                <div class="page-banner text-center">
                    <h1>Checkout</h1>
                    <ul class="page-breadcrumb">
                        <li><a href="/">Home</a></li>
                        <li>Checkout</li>
                    </ul>
                </div>

            </div>
        </div>
    </div>
</div>
<!-- Page Banner Section End -->
<!--Checkout section start-->
<div class="checkout-section section pt-100 pt-lg-80 pt-md-70 pt-sm-60 pt-xs-50  pb-70 pb-lg-50 pb-md-40 pb-sm-30 pb-xs-20">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <!-- Checkout Form Start-->
                @using (Html.BeginForm("Checkout", "Product", FormMethod.Post, new { @class = "checkout-form needs-validation", @novalidate = "novalidate" }))
                {
                    <div class="row row-40">
                        <div class="col-lg-7">
                            <!-- Billing Address -->
                            <div id="billing-form" class="mb-10">
                                <h4 class="checkout-title">Thông tin khách hàng</h4>

                                <div class="row">

                                    <div class="col-12 mb-20">
                                        <label>Họ và tên*</label>
                                        @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control", @placeholder = "Họ và tên", @type = "text", @id = "validationCustom01", @required = "required" } })
                                        @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                                        <div class="invalid-feedback">
                                            Vui lòng điền họ và tên!
                                        </div>
                                        <div class="valid-feedback">
                                            Hợp lệ!
                                        </div>
                                    </div>

                                    <div class="col-md-6 col-12 mb-20">
                                        <label>Email*</label>
                                        @Html.EditorFor(model => model.email, new { htmlAttributes = new { @class = "form-control", @placeholder = "Email", @type = "email", @id = "validationCustom02", @required = "required" } })
                                        @Html.ValidationMessageFor(model => model.email, "", new { @class = "text-danger" })
                                        <div class="invalid-feedback">
                                            Vui lòng điền Email hợp lệ!
                                        </div>
                                        <div class="valid-feedback">
                                            Hợp lệ!
                                        </div>
                                    </div>

                                    <div class="col-md-6 col-12 mb-20">
                                        <label>Số điện thoại*</label>
                                        @Html.EditorFor(model => model.phone, new { htmlAttributes = new { @class = "form-control", @placeholder = "Số điện thoại", @pattern = "(0[3|5|7|8|9])+([0-9]{8})", @type = "phone", @id = "validationCustom03", @required = "required" } })
                                        @Html.ValidationMessageFor(model => model.phone, "", new { @class = "text-danger" })
                                        <div class="invalid-feedback">
                                            Vui lòng điền số điện thoại hợp lệ!
                                        </div>
                                        <div class="valid-feedback">
                                            Hợp lệ!
                                        </div>
                                    </div>

                                    <div class="col-12 mb-20">
                                        <label>Địa chỉ*</label>
                                        @Html.EditorFor(model => model.address, new { htmlAttributes = new { @class = "form-control", @placeholder = "Địa chỉ", @type = "text", @id = "validationCustom04", @required = "required" } })
                                        @Html.ValidationMessageFor(model => model.address, "", new { @class = "text-danger" })
                                        <div class="invalid-feedback">
                                            Vui lòng điền số điện thoại hợp lệ!
                                        </div>
                                        <div class="valid-feedback">
                                            Hợp lệ!
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-5">
                            <div class="row">

                                <!-- Cart Total -->
                                <div class="col-12 mb-60">

                                    <h4 class="checkout-title">Tóm tắt đơn hàng</h4>

                                    <div class="checkout-cart-total">

                                        <h4>Sản phẩm <span>Thành tiền</span></h4>

                                        <ul id="checkoutCartItem"></ul>

                                        <p>Tổng đơn hàng <span id="subTotalInCheckout">0 vnđ</span></p>
                                        <p>Phí ship <span>0 vnđ</span></p>

                                        <h4>Tổng cộng <span id="grandTotalInCheckout">0 vnđ</span></h4>

                                    </div>

                                </div>

                                <!-- Payment Method -->
                                <div class="col-12 mb-30">

                                    <h4 class="checkout-title">Hình thức thanh toán</h4>

                                    <div class="checkout-payment-method">
                                        <div class="single-method">
                                            <input type="radio" id="payment_bank" name="payment-method" value="bank" checked>
                                            <label for="payment_bank">Chuyển khoản</label>
                                            <p data-method="bank">Vui lòng chuyển khoản theo thông tin: <br />Số tài khoản: 0231000582588 <br /> Ngân hàng: Techcombank <br />Chủ tài khoản: Phạm Thùy Vân</p>
                                        </div>

                                        <div class="single-method">
                                            @*<input type="checkbox" id="accept_terms">
                                            <label for="accept_terms">    
                                            </label>*@
                                            <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required>
                                            <label class="form-check-label" for="invalidCheck">
                                                <a target="_blank" href="/dieu-khoan-mua-ban-hang-hoa">Tôi đã đồng ý với chính sách mua bán hàng hóa</a>
                                            </label>
                                            <div class="invalid-feedback">
                                                Bạn phải đồng ý chính sách mua hàng !
                                            </div>
                                        </div>

                                    </div>
                                    <a id="orderButtonAjax" href="javascript:void(0)" class="place-order btn btn-lg btn-round">Đặt hàng</a>
                                    <button hidden id="orderButtonPostBack" class="place-order btn btn-lg btn-round">Đặt hàng</button>
                                </div>

                            </div>
                        </div>

                    </div>
                }
            </div>
        </div>
    </div>
</div>
<!--Checkout section end-->
